# Test that we can start a single one-shot program.
mkdir progdir
gopm -c gopmconfig --quit-delay 0 &
waitfile gopm.socket
waitfile progdir/foo.txt
cmp progdir/foo.txt  expect-foo.txt
gopmctl --addr unix:gopm.socket shutdown
wait

-- gopmconfig/config.cue --
package config

config: grpc_server: {
	network: "unix"
	address: "gopm.socket"
}
config: programs: createfile: {
	command:      "echo hello > foo.txt"
	directory:    "progdir"
}
-- expect-foo.txt --
hello
